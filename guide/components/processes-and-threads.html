<!DOCTYPE html>












































































<html>
<head>


<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width" />

<link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<title>进程和线程 | 安卓开发者</title><!-- STYLESHEETS --><!-- JAVASCRIPT -->


<link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="../../assets/css/default.css" rel="stylesheet" type="text/css">




<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script src="../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "../../";
  var devsite = false;
</script>
<script src="../../assets/js/docs.js" type="text/javascript"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5831155-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="gc-documentation 
  develop guide" itemscope itemtype="http://schema.org/Article"><!-- Header -->

<a name="top"></a>

    
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 logo">
          <a href="../../index.html">
            <img src="../../assets/images/dac_logo.png" width="123" height="25" alt="Android Developers" />
          </a>
          <div class="btn-quicknav" id="btn-quicknav">
          	<a href="#" class="arrow-inactive">Quicknav</a>
			      <a href="#" class="arrow-active">Quicknav</a>
          </div>
          </div>
            <ul class="nav-x col-9">
                <li class="design">
                  <a href="../../design/index.html"
                  zh-tw-lang="設計"
                  zh-cn-lang="设计"
                  ru-lang="Проектирование"
                  ko-lang="디자인"
                  ja-lang="設計"
                  es-lang="Diseñar"               
                  >设计</a></li>
                <li class="develop"><a href="../../develop/index.html"
                  zh-tw-lang="開發"
                  zh-cn-lang="开发"
                  ru-lang="Разработка"
                  ko-lang="개발"
                  ja-lang="開発"
                  es-lang="Desarrollar"               
                  >开发</a></li>
                <li class="distribute last"><a href="../../distribute/index.html"
                  zh-tw-lang="發佈"
                  zh-cn-lang="分发"
                  ru-lang="Распространение"
                  ko-lang="배포"
                  ja-lang="配布"
                  es-lang="Distribuir"               
                  >分发</a></li>
            </ul><!-- New Search -->
            
            
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Links</div>
      <ul>
        <li><a href="https://play.google.com/apps/publish/">Google Play Developer Console</a></li>
        <li><a href="http://android-developers.blogspot.com/">Android Developers Blog</a></li>
        <li><a href="../../about/index.html">About Android</a></li>
      </ul>
      <div class="header">Android Sites</div>
      <ul>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li class="active"><a>Android Developers</a></li>
        <li><a href="http://source.android.com">Android Open Source Project</a></li>
      </ul>
      
      
      
      


      <br class="clearfix" />
    </div>
    <div class="bottom"></div>
  </div>
  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
onkeydown="return search_changed(event, true, '../../')" 
onkeyup="return search_changed(event, false, '../../')" />
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>

  <div class="search_filtered_wrapper reference">
    <div class="suggest-card reference no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  <div class="search_filtered_wrapper docs">
    <div class="suggest-card dummy no-display">&nbsp;</div>
    <div class="suggest-card develop no-display">
      <ul class="search_filtered">
      </ul>
      <div class="child-card guides no-display">
      </div>
      <div class="child-card training no-display">
      </div>
    </div>
    <div class="suggest-card design no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card distribute no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  </div><!-- /New Search>
          
          
          <!-- Expanded quicknav -->
  
           <div id="quicknav" class="col-9">
                <ul>
                    <li class="design">
                      <ul>
                        <li><a href="../../design/index.html">入门</a></li>
                        <li><a href="../../design/style/index.html">样式</a></li>
                        <li><a href="../../design/patterns/index.html">设计模式</a></li>
                        <li><a href="../../design/building-blocks/index.html">构造块</a></li>
                        <li><a href="../../design/downloads/index.html">下载</a></li>
                        <li><a href="../../design/videos/index.html">视频</a></li>
                      </ul>
                    </li>
                    <li class="develop">
                      <ul>
                        <li><a href="../../training/index.html"
                          zh-tw-lang="訓練課程"
                          zh-cn-lang="培训"
                          ru-lang="Курсы"
                          ko-lang="교육"
                          ja-lang="トレーニング"
                          es-lang="Capacitación"               
                          >训练课程</a></li>
                        <li><a href="../../guide/components/index.html"
                          zh-tw-lang="API 指南"
                          zh-cn-lang="API 指南"
                          ru-lang="Руководства по API"
                          ko-lang="API 가이드"
                          ja-lang="API ガイド"
                          es-lang="Guías de la API"               
                          >API 指南</a></li>
                        <li><a href="../../reference/packages.html"
                          zh-tw-lang="參考資源"
                          zh-cn-lang="参考"
                          ru-lang="Справочник"
                          ko-lang="참조문서"
                          ja-lang="リファレンス"
                          es-lang="Referencia"               
                          >参考资源</a></li>
                        <li><a href="../../tools/index.html"
                          zh-tw-lang="相關工具"
                          zh-cn-lang="工具"
                          ru-lang="Инструменты"
                          ko-lang="도구"
                          ja-lang="ツール"
                          es-lang="Herramientas"               
                          >开发工具</a>
                          <ul><li><a href="../../sdk/index.html">获取 SDK</a></li></ul>
                        </li>
                        <li><a href="../../google/index.html">Google 服务</a>
                        </li>
                        
                      </ul>
                    </li>
                    <li class="distribute last">
                      <ul>
                        <li><a href="../../distribute/index.html">Google Play 市场</a></li>
                        <li><a href="../../distribute/googleplay/publish/index.html">应用发布</a></li>
                        <li><a href="../../distribute/googleplay/promote/index.html">应用推广</a></li>
                        <li><a href="../../distribute/googleplay/quality/index.html">应用质量</a></li>
                        <li><a href="../../distribute/googleplay/spotlight/index.html">精品聚焦</a></li>
                        <li><a href="../../distribute/open.html">开放发行</a></li>
                      </ul>
                    </li>
                </ul>
          </div><!-- /Expanded quicknav -->
          
        </div>
    </div><!-- /Header -->
    
    
    
  <div id="searchResults" class="wrap" style="display:none;">
          <h2 id="searchTitle">Results</h2>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div><!-- Secondary x-nav -->
    
    
  
    
    <div id="nav-x">
        <div class="wrap">
            <ul class="nav-x col-9 develop" style="width:100%">
                <li class="training"><a href="../../training/index.html"
                  zh-tw-lang="訓練課程"
                  zh-cn-lang="培训"
                  ru-lang="Курсы"
                  ko-lang="교육"
                  ja-lang="トレーニング"
                  es-lang="Capacitación"               
                  >训练课程</a></li>
                <li class="guide"><a href="../../guide/components/index.html"
                  zh-tw-lang="API 指南"
                  zh-cn-lang="API 指南"
                  ru-lang="Руководства по API"
                  ko-lang="API 가이드"
                  ja-lang="API ガイド"
                  es-lang="Guías de la API"               
                  >API 指南</a></li>
                <li class="reference"><a href="../../reference/packages.html"
                  zh-tw-lang="參考資源"
                  zh-cn-lang="参考"
                  ru-lang="Справочник"
                  ko-lang="참조문서"
                  ja-lang="リファレンス"
                  es-lang="Referencia"               
                  >参考资源</a></li>
                <li class="tools"><a href="../../tools/index.html"
                  zh-tw-lang="相關工具"
                  zh-cn-lang="工具"
                  ru-lang="Инструменты"
                  ko-lang="도구"
                  ja-lang="ツール"
                  es-lang="Herramientas"
                  >开发工具</a></li>
                <li class="google"><a href="../../google/index.html"
                  >Google 服务</a>
                </li>
                
            </ul>
        </div>
        
    </div><!-- /Sendondary x-nav -->
    
  




  

  <div class="wrap clearfix" id="body-content">
    <div class="col-4" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<a class="totop" href="#top" data-g-event="left-nav-top">to top</a>



<ul id="nav"><!--  Walkthrough for Developers -- quick overview of what it's like to develop on Android --><!--<li style="color:red">Overview</li> -->
  
  

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../guide/components/index.html">
        <span class="en">应用组件</span>
      </a></div>
    <ul>
      <li><a href="../../guide/components/fundamentals.html">
            <span class="en">应用基本知识</span></a>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/components/activities.html">
            <span class="en">活动</span>
          </a></div>
        <ul>
          <li><a href="../../guide/components/fragments.html">
              <span class="en">活动片段</span>
            </a></li>
          <li><a href="../../guide/components/loaders.html">
              <span class="en">加载器</span>
            </a></li>
          <li><a href="../../guide/components/tasks-and-back-stack.html">
              <span class="en">任务和活动堆栈</span>
            </a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/components/services.html">
            <span class="en">服务</span>
          </a></div>
        <ul>
          <li><a href="../../guide/components/bound-services.html">
              <span class="en">绑定服务</span>
            </a></li>
          <li><a href="../../guide/components/aidl.html">
              <span class="en">AIDL</span>
            </a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/providers/content-providers.html">
            <span class="en">内容提供商</span>
          </a></div>
        <ul>
          <li><a href="../../guide/topics/providers/content-provider-basics.html">
              <span class="en">内容提供商基础</span>
            </a></li>
          <li><a href="../../guide/topics/providers/content-provider-creating.html">
              <span class="en">创建一个内容提供商</span>
            </a></li>
          <li><a href="../../guide/topics/providers/calendar-provider.html">
              <span class="en">日历提供商</span>
            </a></li>
          <li><a href="../../guide/topics/providers/contacts-provider.html">
              <span class="en">联系人提供商</span>
            </a></li>
          <li><a href="../../guide/topics/providers/document-provider.html">
              <span class="en">存储访问框架</span>
            </a></li>
        </ul>
      </li>
      <li><a href="../../guide/components/intents-filters.html">
          <span class="en">意图与意图过滤器</span>
        </a></li>
      <li><a href="../../guide/components/processes-and-threads.html">
          <span class="en">进程和线程</span>
        </a>
      </li>
      <li><a href="../../guide/topics/security/permissions.html">
          <span class="en">权限</span>
        </a>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/appwidgets/index.html">
            <span class="en">应用小部件</span>
          </a></div>
        <ul>
          <li><a href="../../guide/topics/appwidgets/host.html">
              <span class="en">应用小部件托管</span>
            </a></li>
        </ul>
      </li>
      <li class="nav-section">
      <div class="nav-section-header"><a href="../../guide/topics/manifest/manifest-intro.html">
          <span class="en">安卓项目清单</span>
        </a></div>
        <ul>
          <li><a href="../../guide/topics/manifest/action-element.html">&lt;action&gt;</a></li>
          <li><a href="../../guide/topics/manifest/activity-element.html">&lt;activity&gt;</a></li>
          <li><a href="../../guide/topics/manifest/activity-alias-element.html">&lt;activity-alias&gt;</a></li>
          <li><a href="../../guide/topics/manifest/application-element.html">&lt;application&gt;</a></li>
          <li><a href="../../guide/topics/manifest/category-element.html">&lt;category&gt;</a></li>
          <li><a href="../../guide/topics/manifest/compatible-screens-element.html">&lt;compatible-screens&gt;</a></li>
          <li><a href="../../guide/topics/manifest/data-element.html">&lt;data&gt;</a></li>
          <li><a href="../../guide/topics/manifest/grant-uri-permission-element.html">&lt;grant-uri-permission&gt;</a></li>
          <li><a href="../../guide/topics/manifest/instrumentation-element.html">&lt;instrumentation&gt;</a></li>
          <li><a href="../../guide/topics/manifest/intent-filter-element.html">&lt;intent-filter&gt;</a></li>
          <li><a href="../../guide/topics/manifest/manifest-element.html">&lt;manifest&gt;</a></li>
          <li><a href="../../guide/topics/manifest/meta-data-element.html">&lt;meta-data&gt;</a></li>
          <li><a href="../../guide/topics/manifest/path-permission-element.html">&lt;path-permission&gt;</a></li>
          <li><a href="../../guide/topics/manifest/permission-element.html">&lt;permission&gt;</a></li>
          <li><a href="../../guide/topics/manifest/permission-group-element.html">&lt;permission-group&gt;</a></li>
          <li><a href="../../guide/topics/manifest/permission-tree-element.html">&lt;permission-tree&gt;</a></li>
          <li><a href="../../guide/topics/manifest/provider-element.html">&lt;provider&gt;</a></li>
          <li><a href="../../guide/topics/manifest/receiver-element.html">&lt;receiver&gt;</a></li>
          <li><a href="../../guide/topics/manifest/service-element.html">&lt;service&gt;</a></li>
          <li><a href="../../guide/topics/manifest/supports-gl-texture-element.html">&lt;supports-gl-texture&gt;</a></li>
          <li><a href="../../guide/topics/manifest/supports-screens-element.html">&lt;supports-screens&gt;</a></li><!-- ##api level 4## -->
          <li><a href="../../guide/topics/manifest/uses-configuration-element.html">&lt;uses-configuration&gt;</a></li>
          <li><a href="../../guide/topics/manifest/uses-feature-element.html">&lt;uses-feature&gt;</a></li><!-- ##api level 4## --> 
          <li><a href="../../guide/topics/manifest/uses-library-element.html">&lt;uses-library&gt;</a></li>
          <li><a href="../../guide/topics/manifest/uses-permission-element.html">&lt;uses-permission&gt;</a></li>
          <li><a href="../../guide/topics/manifest/uses-sdk-element.html">&lt;uses-sdk&gt;</a></li>
        </ul>
   </li><!-- end of the manifest file -->

    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../guide/topics/ui/index.html">
        <span class="en">用户界面</span>
      </a></div>
    <ul>
      <li><a href="../../guide/topics/ui/overview.html">
          <span class="en">概述</span>
        </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/ui/declaring-layout.html">
            <span class="en">布局</span>
          </a></div>
        <ul>
          <li><a href="../../guide/topics/ui/layout/linear.html">
              <span class="en">线性布局</span>
            </a></li>
          <li><a href="../../guide/topics/ui/layout/relative.html">
              <span class="en">相对布局</span>
            </a></li><!--
          <li><a href="../../guide/topics/ui/layout/grid.html">
              <span class="en">Grid Layout</span>
            </a></li>
       -->
       
          <li><a href="../../guide/topics/ui/layout/listview.html">
              <span class="en">列表视图</span>
            </a></li>
          <li><a href="../../guide/topics/ui/layout/gridview.html">
              <span class="en">网格视图</span>
            </a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/ui/controls.html">
            <span class="en">输入控件</span>
          </a></div>
        <ul>
          <li><a href="../../guide/topics/ui/controls/button.html">
              <span class="en">按钮</span>
            </a></li>
          <li><a href="../../guide/topics/ui/controls/text.html">
              <span class="en">文本框</span>
            </a></li>
          <li><a href="../../guide/topics/ui/controls/checkbox.html">
              <span class="en">复选框</span>
            </a></li>
          <li><a href="../../guide/topics/ui/controls/radiobutton.html">
              <span class="en">单选按钮</span>
            </a></li>
          <li><a href="../../guide/topics/ui/controls/togglebutton.html">
              <span class="en">切换按钮</span>
            </a></li>
          <li><a href="../../guide/topics/ui/controls/spinner.html">
              <span class="en">下拉列表</span>
            </a></li>
          <li><a href="../../guide/topics/ui/controls/pickers.html">
              <span class="en">选择器</span>
            </a></li><!--
          <li><a href="../../guide/topics/ui/controls/progress.html">
              <span class="en">Seek and Progress Bars</span>
            </a></li>
-->

        </ul>
      </li>
      <li><a href="../../guide/topics/ui/ui-events.html">
          <span class="en">输入事件</span>
        </a></li>
      <li><a href="../../guide/topics/ui/menus.html">
          <span class="en">菜单</span></span>
          </a></li>
      <li><a href="../../guide/topics/ui/actionbar.html">
           <span class="en">操作栏</span>
          </a></li>
      <li><a href="../../guide/topics/ui/settings.html">
            <span class="en">设置</span>
          </a></li>
      <li><a href="../../guide/topics/ui/dialogs.html">
           <span class="en">对话框</span>
          </a></li>
      <li><a href="../../guide/topics/ui/notifiers/notifications.html">
          <span class="en">通知</span>
        </a></li>
      <li><a href="../../guide/topics/ui/notifiers/toasts.html">
          <span class="en">提醒框</span>
        </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/search/index.html">
            <span class="en">搜索</span>
          </a></div>
          <ul>
            <li><a href="../../guide/topics/search/search-dialog.html">创建一个搜索界面</a></li>
            <li><a href="../../guide/topics/search/adding-recent-query-suggestions.html">添加最近查询建议</a></li>
            <li><a href="../../guide/topics/search/adding-custom-suggestions.html">添加自定义建议</a></li>
            <li><a href="../../guide/topics/search/searchable-config.html">可搜索配置</a></li>
          </ul>
      </li>
      <li><a href="../../guide/topics/ui/drag-drop.html">
          <span class="en">拖放</span>
        </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/ui/accessibility/index.html">
            <span class="en">辅助功能</span>
          </a></div>
        <ul>
          <li><a href="../../guide/topics/ui/accessibility/apps.html">
              <span class="en">让应用可访问</span>
            </a></li>
          <li><a href="../../guide/topics/ui/accessibility/checklist.html">
              <span class="en">辅助功能开发者清单</span>
            </a></li>
          <li><a href="../../guide/topics/ui/accessibility/services.html">
              <span class="en">构建辅助功能服务</span>
            </a></li>
        </ul>
      </li>
      <li><a href="../../guide/topics/ui/themes.html">
          <span class="en">样式与主题</span>
        </a></li>
      <li><a href="../../guide/topics/ui/custom-components.html">
          <span class="en">自定义组件</span>
        </a></li>
    </ul>
  </li><!-- end of User Interface -->

    <li class="nav-section">
      <div class="nav-section-header"><a href="../../guide/topics/resources/index.html">
           <span class="en">应用资源</span>
         </a></div>
      <ul>
        <li><a href="../../guide/topics/resources/overview.html">
            <span class="en">概述</span>
          </a></li>
          <li><a href="../../guide/topics/resources/providing-resources.html">
            <span class="en">提供资源</span>
          </a></li>
        <li><a href="../../guide/topics/resources/accessing-resources.html">
            <span class="en">访问资源</span>
          </a></li>
        <li><a href="../../guide/topics/resources/runtime-changes.html">
              <span class="en">处理运行时更改</span>
            </a></li>
        <li><a href="../../guide/topics/resources/localization.html">
            <span class="en">本地化</span>
          </a></li>
        <li class="nav-section">
          <div class="nav-section-header"><a href="../../guide/topics/resources/available-resources.html">
              <span class="en">资源类型</span>
            </a></div>
          <ul>
            <li><a href="../../guide/topics/resources/animation-resource.html">动画</a></li>
            <li><a href="../../guide/topics/resources/color-list-resource.html">颜色状态列表</a></li>
            <li><a href="../../guide/topics/resources/drawable-resource.html">可描绘资源</a></li>
            <li><a href="../../guide/topics/resources/layout-resource.html">布局</a></li>
            <li><a href="../../guide/topics/resources/menu-resource.html">菜单</a></li>
            <li><a href="../../guide/topics/resources/string-resource.html">字符串</a></li>
            <li><a href="../../guide/topics/resources/style-resource.html">样式</a></li>
            <li><a href="../../guide/topics/resources/more-resources.html">更多类型</a></li>
          </ul>
        </li><!-- end of resource types -->
      </ul>
    </li><!-- end of app resources -->

   <li class="nav-section">
      <div class="nav-section-header"><a href="../../guide/topics/graphics/index.html">
          <span class="en">动画与图形</span>
        </a></div>
      <ul>
      <li class="nav-section">
        </li><li><a href="../../guide/topics/graphics/overview.html">
            <span class="en">概述</span>
          </a></li>
        <li><a href="../../guide/topics/graphics/prop-animation.html">
            <span class="en">属性动画</span>
          </a></li>
        <li><a href="../../guide/topics/graphics/view-animation.html">
            <span class="en">补间动画</span>
          </a></li>
        <li><a href="../../guide/topics/graphics/drawable-animation.html">
            <span class="en">帧动画</span>
          </a></li>
        <li><a href="../../guide/topics/graphics/2d-graphics.html">
            <span class="en">画布与图形</span>
          </a></li>
        <li><a href="../../guide/topics/graphics/opengl.html">
            <span class="en">OpenGL ES</span>
          </a></li>
        <li><a href="../../guide/topics/graphics/hardware-accel.html">
            <span class="en">硬件加速</span>
          </a></li>
       </ul>
    </li><!-- end of graphics and animation-->

   <li class="nav-section">
            <div class="nav-section-header"><a href="../../guide/topics/renderscript/index.html">
              <span class="en">计算</span>
            </a></div>
            <ul>
              <li><a href="../../guide/topics/renderscript/compute.html">
                    <span class="en">RenderScript</span></a>
                  </li>

              <li><a href="../../guide/topics/renderscript/advanced.html">
                    <span class="en">RenderScript 进阶</span></a>
                  </li>
              <li><a href="../../guide/topics/renderscript/reference.html">
                    <span class="en">运行时 API 参考</span></a>
              </li>
             </ul>
   </li>
      <li class="nav-section">
          <div class="nav-section-header"><a href="../../guide/topics/media/index.html">
            <span class="en">多媒体与照相机</span>
          </a></div>
          <ul>
            <li><a href="../../guide/topics/media/mediaplayer.html">
                  <span class="en">多媒体播放</span></a>
                </li>
            <li><a href="../../guide/appendix/media-formats.html">
                   <span class="en">支持的多媒体格式</span></a>
                </li>
            <li><a href="../../guide/topics/media/audio-capture.html">
                  <span class="en">音频录制</span></a>
                </li>
            <li><a href="../../guide/topics/media/jetplayer.html">
                  <span class="en">JetPlayer</span></a>
                </li>
            <li><a href="../../guide/topics/media/camera.html">
                  <span class="en">照相机</span></a>
                </li>
          </ul>
      </li><!-- end of media and camera -->

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/sensors/index.html">
              <span class="en">位置与传感器</span>
              </a></div>
        <ul>
          <li><a href="../../guide/topics/location/index.html">
               <span class="en">位置和地图</span>
             </a>
          </li><li><a href="../../guide/topics/location/strategies.html">
               <span class="en">位置策略</span>
             </a></li>
          <li><a href="../../guide/topics/sensors/sensors_overview.html">
              <span class="en">传感器概述</span>
            </a></li>
          <li><a href="../../guide/topics/sensors/sensors_motion.html">
              <span class="en">动作传感器</span>
            </a></li>
          <li><a href="../../guide/topics/sensors/sensors_position.html">
              <span class="en">位置传感器</span>
            </a></li>
          <li><a href="../../guide/topics/sensors/sensors_environment.html">
              <span class="en">环境传感器</span>
            </a></li>
        </ul>
      </li><!-- end of location and sensors -->



<li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/connectivity/index.html">
               <span class="en">连接性</span>
             </a></div>
        <ul>
          <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/connectivity/bluetooth.html">
          <span class="en">蓝牙</span></a>
        </div>
        <ul>
          <li><a href="../../guide/topics/connectivity/bluetooth-le.html">低功耗蓝牙</a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/connectivity/nfc/index.html">
          <span class="en">NFC</span></a>
        </div>
        <ul>
          <li><a href="../../guide/topics/connectivity/nfc/nfc.html">NFC 基础</a></li>
          <li><a href="../../guide/topics/connectivity/nfc/advanced-nfc.html">高级 NFC</a></li>
          <li><a href="../../guide/topics/connectivity/nfc/hce.html">Host-based Card Emulation</a></li>
        </ul>
      </li>
      <li><a href="../../guide/topics/connectivity/wifip2p.html">
            <span class="en">Wi-Fi P2P</span></a>
          </li>
      <li class="nav-section">
          <div class="nav-section-header"><a href="../../guide/topics/connectivity/usb/index.html">
            <span class="en">USB</span></a>
          </div>
            <ul>
              <li><a href="../../guide/topics/connectivity/usb/accessory.html">附件</a></li>
              <li><a href="../../guide/topics/connectivity/usb/host.html">主机</a></li>
            </ul>
     </li>
     <li><a href="../../guide/topics/connectivity/sip.html">
            <span class="en">SIP</span>
          </a>
     </li>

    </ul>
  </li><!-- end of connectivity -->


      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/topics/text/index.html">
            <span class="en">文本与输入</span>
        </a></div>
        <ul>
          <li><a href="../../guide/topics/text/copy-paste.html">
              <span class="en">复制和粘贴</span>
            </a></li>
          <li><a href="../../guide/topics/text/creating-input-method.html">
              <span class="en">创建输入法引擎</span>
            </a></li>
          <li><a href="../../guide/topics/text/spell-checker-framework.html">
              <span class="en">拼写检查</span>
            </a></li>
        </ul>
      </li><!-- end of text and input -->

     <li class="nav-section">
      <div class="nav-section-header"><a href="../../guide/topics/data/index.html">
          <span class="en">数据存储</span>
        </a></div>
      <ul>
         <li><a href="../../guide/topics/data/data-storage.html">
            <span class="en">存储选项</span>
           </a></li>
        <li><a href="../../guide/topics/data/backup.html">
            <span class="en">数据备份</span>
          </a></li>
        <li><a href="../../guide/topics/data/install-location.html">
            <span class="en">应用安装位置</span>
          </a></li>
      </ul>
    </li><!-- end of data storage -->


  <li class="nav-section">
           <div class="nav-section-header"><a href="../../guide/topics/admin/index.html">
               <span class="en">管理</span>
             </a></div>
           <ul>
              <li>
                <a href="../../guide/topics/admin/device-admin.html">
                <span class="en">设备管理</span></a>
              </li><!--
              <li>
                <a href="../../guide/topics/admin/keychain.html">
                <span class="en">Certificate Store</span></a>
              </li>
            -->
            
           </ul>
  </li><!-- end of administration -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../guide/webapps/index.html">
    <span class="en">Web 应用</span>
    </a></div>
    <ul>
      <li><a href="../../guide/webapps/overview.html">
            <span class="en">概述</span>
          </a></li>
      <li><a href="../../guide/webapps/targeting.html">
            <span class="en">Web 应用的目标屏幕</span>
          </a></li>
      <li><a href="../../guide/webapps/webview.html">
            <span class="en">在 WebView 中创建 Web 应用</span>
          </a></li>
      <li><a href="../../guide/webapps/migrating.html">
            <span class="en">迁移到 Android 4.4 版本的 WebView</span>
          </a></li>
      <li><a href="../../guide/webapps/debugging.html">
            <span class="en">Web 应用调试</span>
          </a></li>
      <li><a href="../../guide/webapps/best-practices.html">
            <span class="en">Web 应用的最佳实践</span>
          </a></li>
    </ul>
  </li><!-- end of web apps -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../guide/practices/index.html">
      <span class="en">最佳实践</span> <span class="de" style="display:none">Bewährte Verfahren</span> <span class="es" style="display:none">Prácticas recomendadas</span> <span class="fr" style="display:none">Meilleures pratiques</span> <span class="it" style="display:none">Best practice</span> <span class="ja" style="display:none">ベスト プラクティス</span> <span class="zh-cn" style="display:none">最佳实践</span> <span class="zh-tw" style="display:none">最佳實務</span>
    </a></div></a>
    <ul>
      <li><a href="../../guide/practices/compatibility.html">
            <span class="en">兼容性</span>
          </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/practices/screens_support.html">
          <span class="en">支持多个屏幕</span>
        </a></div>
        <ul>
          <li><a href="../../guide/practices/screens-distribution.html">
            <span class="en">分发给特定的屏幕</span>
          </a></li>
          <li><a href="../../guide/practices/screen-compat-mode.html">
            <span class="en">屏幕兼容性模式</span>
          </a></li>
        </ul>
      </li>
      <li><a href="../../guide/practices/tablets-and-handsets.html">
            <span class="en">支持平板设备和手持设备</span>
          </a></li>

    </ul>
  </li><!-- this needs to move
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../guide/practices/ui_guidelines/index.html">
               <span class="en">UI Guidelines</span>
             </a></div>
        <ul>
          <li class="nav-section">
            <div class="nav-section-header"><a href="../../guide/practices/ui_guidelines/icon_design.html">
                   <span class="en">Icon Design</span>
                 </a></div>
            <ul>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_launcher.html">
                    <span class="en">Launcher Icons</span>
                  </a></li>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_menu.html">
                    <span class="en">Menu Icons</span>
                  </a></li>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_action_bar.html">
                    <span class="en">Action Bar Icons</span>
                  </a></li>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_status_bar.html">
                    <span class="en">Status Bar Icons</span>
                  </a></li>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_tab.html">
                    <span class="en">Tab Icons</span>
                  </a></li>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_dialog.html">
                    <span class="en">Dialog Icons</span>
                  </a></li>
              <li><a href="../../guide/practices/ui_guidelines/icon_design_list.html">
                    <span class="en">List View Icons</span>
                  </a></li>
            </ul>
          </li>
          <li><div><a href="../../guide/practices/ui_guidelines/widget_design.html">
                <span class="en">App Widget Design</span>
              </a></div>
          </li>
        </ul>
      </li>
        </ul> --><!-- Remove
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../guide/appendix/index.html">
        <span class="en">Appendix</span>
        <span class="de" style="display:none">Anhang</span>
        <span class="es" style="display:none">Apéndice</span>
        <span class="fr" style="display:none">Annexes</span>
        <span class="it" style="display:none">Appendice</span>
        <span class="ja" style="display:none">付録</span>
        <span class="zh-cn" style="display:none">附录</span>
        <span class="zh-tw" style="display:none">附錄</span>
      </a></div>
    <ul>
      <li><a href="../../guide/appendix/g-app-intents.html">
            <span class="en">Intents List: Google Apps</span>
          </a></li>


      <li><a href="../../guide/appendix/glossary.html">
            <span class="en">Glossary</span>
          </a></li>
    </ul>
  </li>

</li>
-->

      


</ul>


<script type="text/javascript">
<!--
    buildToggleLists();
    changeNavLang(getLangPref());
//-->
</script>


        

      </div>
    </div><!-- end side-nav --> 
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="col-12" id="doc-col" >


  
    
      
        <h1 itemprop="name" >进程和线程</h1>
      
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <div id="qv-wrapper">
<div id="qv">
<h2>要点</h2>
<ul>
  <li>每一个应用都运行在自己的进程中，默认应用中所有的组件也都运行在这个进程里。</li>
  <li>活动中任何缓慢的、阻塞的操作都应该在新线程中执行，以避免减慢用户界面的运行。</li>
</ul>

<h2>在这个文档中</h2>
<ol>
<li><a href="#Processes">进程</a>
  <ol>
    <li><a href="#Lifecycle">进程生命周期</a></li>
  </ol>
</li>
<li><a href="#Threads">线程</a>
  <ol>
    <li><a href="#WorkerThreads">工作线程</a></li>
    <li><a href="#ThreadSafe">线程安全方法</a></li>
  </ol>
</li>
<li><a href="#IPC">进程间通信</a></li>
</ol>

</div>
</div>

<p>当一个应用程序在没有其他组件在运行的时候启动，安卓系统会启动为其一个新的单线程 Linux 进程来执行。默认情况下，同一个应用程序的所有组件运行在同一个进程和线程（主线程）中。如果当一个应用程序组件启动的时候，系统中已经存在该应用的进程（因为应用的其它组件已经在运行了），那么这个组件将会在这个已经存在的进程中启动并使用同一个线程来执行。但是，你也可以将你的应用中的不同组件安排在不同的进程中执行，同时你也可以为任意一个进程创建多个附加的线程。</p>

<p>这个文档将讨论进程和线程如何在安卓应用中工作。</p>


<h2 id="Processes">进程</h2>

<p>一般来说，同一个应用的所有组件都应该在同一个进程中运行，大部分应用程序都应该遵循这个原则。不过，当你发现你需要控制某一个组件属于哪一个进程时，你可以通过修改项目清单文件来实现。</p>

<p>每一类组件元素的清单项 — <a
href="../../guide/topics/manifest/activity-element.html"><code>&lt;activity&gt;</code></a>，<a href="../../guide/topics/manifest/service-element.html"><code>&lt;service&gt;</code></a>，<a href="../../guide/topics/manifest/receiver-element.html"><code>&lt;receiver&gt;</code></a> 和 <a href="../../guide/topics/manifest/provider-element.html"><code>&lt;provider&gt;</code></a> — 都支持 <code>android:process</code> 属性，这个属性可以指定对应的组件运行在一个特定的进程中。你可以设定这个属性以便让每一个组件都在它们自己的进程中运行，或者也可以让部分组件共享某一个进程但其他的组件不共享。你也可以通过设置 <code>android:process</code> 让不同应用程序的组件运行在同一个进程中 — 让这些应用程序共享同一个 Linux 用户 ID 同时使用同样的证书来签名。</p>

<p><a href="../../guide/topics/manifest/application-element.html"><code>&lt;application&gt;</code></a> 元素同样支持 <code>android:process</code> 属性，它用于设定一个默认的值应用在所以的组件上。</p>

<p>当系统内存过低而且有其他对用户来说更加紧急的进程请求内存的时候，安卓系统将会在某一个时间点杀死一个进程。那些运行在这个被杀死的进程中的应用程序组件将会因此而被销毁。当这些组件再次继续它们之前的操作时，它们对应的进程也会再次启动。</p>

<p>安卓系统将以各个进程对用户的相对重要程度为权重，来决定哪一个进程将被杀死。例如，和一个托管可见活动的进程相比，杀死一个托管不可见活动的进程显然更容易。因此，决定一个进程是否终止取决于这个进程中的组件的运行状态。下面讨论的将是用于决定哪一个进程将被终止的规则。 </p>


<h3 id="Lifecycle">进程生命周期</h3>

<p>The Android system tries to maintain an application process for as long as possible, but
eventually needs to remove old processes to reclaim memory for new or more important processes.  To
determine which processes to keep
and which to kill, the system places each process into an "importance hierarchy" based on the
components running in the process and the state of those components.  Processes with the lowest
importance are eliminated first, then those with the next lowest importance, and so on, as necessary
to recover system resources.</p>

<p>There are five levels in the importance hierarchy. The following list presents the different
types of processes in order of importance (the first process is <em>most important</em> and is
<em>killed last</em>):</p>

<ol>
  <li><b>Foreground process</b>
    <p>A process that is required for what the user is currently doing.  A
      process is considered to be in the foreground if any of the following conditions are true:</p>

      <ul>
        <li>It hosts an <code><a href="../../reference/android/app/Activity.html">Activity</a></code> that the user is interacting with (the <code><a href="../../reference/android/app/Activity.html">Activity</a></code>'s <code><a href="../../reference/android/app/Activity.html#onResume()">onResume()</a></code> method has been
called).</li>

        <li>It hosts a <code><a href="../../reference/android/app/Service.html">Service</a></code> that's bound to the activity that the user is
interacting with.</li>

        <li>It hosts a <code><a href="../../reference/android/app/Service.html">Service</a></code> that's running "in the foreground"—the
service has called <code><a href="../../reference/android/app/Service.html#startForeground(int, android.app.Notification)">startForeground()</a></code>.

        

        </li><li>It hosts a <code><a href="../../reference/android/app/Service.html">Service</a></code> that's executing one of its lifecycle
callbacks (<code><a href="../../reference/android/app/Service.html#onCreate()">onCreate()</a></code>, <code><a href="../../reference/android/app/Service.html#onStart(android.content.Intent, int)">onStart()</a></code>, or <code><a href="../../reference/android/app/Service.html#onDestroy()">onDestroy()</a></code>).</li>

        <li>It hosts a <code><a href="../../reference/android/content/BroadcastReceiver.html">BroadcastReceiver</a></code> that's executing its <code><a href="../../reference/android/content/BroadcastReceiver.html#onReceive(android.content.Context, android.content.Intent)">onReceive()</a></code> method.</li>
    </ul>

    <p>Generally, only a few foreground processes exist at any given time.  They are killed only as
a last resort—if memory is so low that they cannot all continue to run.  Generally, at that
point, the device has reached a memory paging state, so killing some foreground processes is
required to keep the user interface responsive.</p></li>

  <li><b>Visible process</b>
    <p>A process that doesn't have any foreground components, but still can
      affect what the user sees on screen. A process is considered to be visible if either of the
      following conditions are true:</p>

      <ul>
        <li>It hosts an <code><a href="../../reference/android/app/Activity.html">Activity</a></code> that is not in the foreground, but is still
visible to the user (its <code><a href="../../reference/android/app/Activity.html#onPause()">onPause()</a></code> method has been called). 
This might occur, for example, if the foreground activity started a dialog, which allows the
previous activity to be seen behind it.</li>

        <li>It hosts a <code><a href="../../reference/android/app/Service.html">Service</a></code> that's bound to a visible (or foreground)
activity.</li>
      </ul>

      <p>A visible process is considered extremely important and will not be killed unless doing so
is required to keep all foreground processes running.  </p>
    </li>

  <li><b>Service process</b>
    <p>A process that is running a service that has been started with the <code><a href="../../reference/android/content/Context.html#startService(android.content.Intent)">startService()</a></code> method and does not fall into either of the two
higher categories. Although service processes are not directly tied to anything the user sees, they
are generally doing things that the user cares about (such as playing music in the background or
downloading  data on the network), so the system keeps them running unless there's not enough memory
to retain them along with all foreground and visible processes.  </p>
  </li>

  <li><b>Background process</b>
    <p>A process holding an activity that's not currently visible to the user  (the activity's
<code><a href="../../reference/android/app/Activity.html#onStop()">onStop()</a></code> method has been called). These processes have no direct
impact on the user experience, and the system can kill them at any time to reclaim memory for a
foreground,
visible, or service process. Usually there are many background processes running, so they are kept
in an LRU (least recently used) list to ensure that the process with the activity that was most
recently seen by the user is the last to be killed. If an activity implements its lifecycle methods
correctly, and saves its current state, killing its process will not have a visible effect on
the user experience, because when the user navigates back to the activity, the activity restores
all of its visible state. See the <a
href="../../guide/components/activities.html#SavingActivityState">Activities</a>
document for information about saving and restoring state.</p>
  </li>

  <li><b>Empty process</b>
    <p>A process that doesn't hold any active application components.  The only reason to keep this
kind of process alive is for caching purposes, to improve startup time the next time a component
needs to run in it.  The system often kills these processes in order to balance overall system
resources between process caches and the underlying kernel caches.</p>
  </li>
</ol>


  <p>Android ranks a process at the highest level it can, based upon the importance of the
components currently active in the process.  For example, if a process hosts a service and a visible
activity, the process is ranked as a visible process, not a service process.</p>

  <p>In addition, a process's ranking might be increased because other processes are dependent on
it—a process that is serving another process can never be ranked lower than the process it is
serving. For example, if a content provider in process A is serving a client in process B, or if a
service in process A is bound to a component in process B, process A is always considered at least
as important as process B.</p>

  <p>Because a process running a service is ranked higher than a process with background activities,
an activity that initiates a long-running operation might do well to start a <a
href="../../guide/components/services.html">service</a> for that operation, rather than
simply create a worker thread—particularly if the operation will likely outlast the activity.
For example, an activity that's uploading a picture to a web site should start a service to perform
the upload so that the upload can continue in the background even if the user leaves the activity.
Using a service guarantees that the operation will have at least "service process" priority,
regardless of what happens to the activity. This is the same reason that broadcast receivers should
employ services rather than simply put time-consuming operations in a thread.</p>




<h2 id="Threads">线程</h2>

<p>When an application is launched, the system creates a thread of execution for the application,
called "main." This thread is very important because it is in charge of dispatching events to
the appropriate user interface widgets, including drawing events. It is also the thread in which
your application interacts with components from the Android UI toolkit (components from the <code><a href="../../reference/android/widget/package-summary.html">android.widget</a></code> and <code><a href="../../reference/android/view/package-summary.html">android.view</a></code> packages). As such, the main thread is also sometimes
called the UI thread.</p>

<p>The system does <em>not</em> create a separate thread for each instance of a component. All
components that run in the same process are instantiated in the UI thread, and system calls to
each component are dispatched from that thread. Consequently, methods that respond to system
callbacks (such as <code><a href="../../reference/android/view/View.html#onKeyDown(int, android.view.KeyEvent)">onKeyDown()</a></code> to report user actions
or a lifecycle callback method) always run in the UI thread of the process.</p>

<p>For instance, when the user touches a button on the screen, your app's UI thread dispatches the
touch event to the widget, which in turn sets its pressed state and posts an invalidate request to
the event queue. The UI thread dequeues the request and notifies the widget that it should redraw
itself.</p>

<p>When your app performs intensive work in response to user interaction, this single thread model
can yield poor performance unless you implement your application properly. Specifically, if
everything is happening in the UI thread, performing long operations such as network access or
database queries will block the whole UI. When the thread is blocked, no events can be dispatched,
including drawing events. From the user's perspective, the
application appears to hang. Even worse, if the UI thread is blocked for more than a few seconds
(about 5 seconds currently) the user is presented with the infamous "<a
href="http://developer.android.com/guide/practices/responsiveness.html">application not
responding</a>" (ANR) dialog. The user might then decide to quit your application and uninstall it
if they are unhappy.</p>

<p>Additionally, the Andoid UI toolkit is <em>not</em> thread-safe. So, you must not manipulate
your UI from a worker thread—you must do all manipulation to your user interface from the UI
thread. Thus, there are simply two rules to Android's single thread model:</p>

<ol>
<li>Do not block the UI thread

</li><li>Do not access the Android UI toolkit from outside the UI thread

</li></ol>

<h3 id="WorkerThreads">工作线程</h3>

<p>Because of the single thread model described above, it's vital to the responsiveness of your
application's UI that you do not block the UI thread. If you have operations to perform
that are not instantaneous, you should make sure to do them in separate threads ("background" or
"worker" threads).</p>

<p>For example, below is some code for a click listener that downloads an image from a separate
thread and displays it in an <code><a href="../../reference/android/widget/ImageView.html">ImageView</a></code>:</p>

<pre>
public void onClick(View v) {
    new Thread(new Runnable() {
        public void run() {
            Bitmap b = loadImageFromNetwork("http://example.com/image.png");
            mImageView.setImageBitmap(b);
        }
    }).start();
}
</pre>

<p>At first, this seems to work fine, because it creates a new thread to handle the network
operation. However, it violates the second rule of the single-threaded model: <em>do not access the
Android UI toolkit from outside the UI thread</em>—this sample modifies the <code><a href="../../reference/android/widget/ImageView.html">ImageView</a></code> from the worker thread instead of the UI thread. This can result in
undefined and unexpected behavior, which can be difficult and time-consuming to track down.</p>

<p>To fix this problem, Android offers several ways to access the UI thread from other
threads. Here is a list of methods that can help:</p>

<ul>
<li><code><a href="../../reference/android/app/Activity.html#runOnUiThread(java.lang.Runnable)">Activity.runOnUiThread(Runnable)</a></code></li>
<li><code><a href="../../reference/android/view/View.html#post(java.lang.Runnable)">View.post(Runnable)</a></code></li>
<li><code><a href="../../reference/android/view/View.html#postDelayed(java.lang.Runnable, long)">View.postDelayed(Runnable,
long)</a></code></li>
</ul>

<p>For example, you can fix the above code by using the <code><a href="../../reference/android/view/View.html#post(java.lang.Runnable)">View.post(Runnable)</a></code> method:</p>

<pre>
public void onClick(View v) {
    new Thread(new Runnable() {
        public void run() {
            final Bitmap bitmap = loadImageFromNetwork("http://example.com/image.png");
            mImageView.post(new Runnable() {
                public void run() {
                    mImageView.setImageBitmap(bitmap);
                }
            });
        }
    }).start();
}
</pre>

<p>Now this implementation is thread-safe: the network operation is done from a separate thread
while the <code><a href="../../reference/android/widget/ImageView.html">ImageView</a></code> is manipulated from the UI thread.</p>

<p>However, as the complexity of the operation grows, this kind of code can get complicated and
difficult to maintain. To handle more complex interactions with a worker thread, you might consider
using a <code><a href="../../reference/android/os/Handler.html">Handler</a></code> in your worker thread, to process messages delivered from the UI
thread. Perhaps the best solution, though, is to extend the <code><a href="../../reference/android/os/AsyncTask.html">AsyncTask</a></code> class,
which simplifies the execution of worker thread tasks that need to interact with the UI.</p>


<h4 id="AsyncTask">Using AsyncTask</h4>

<p><code><a href="../../reference/android/os/AsyncTask.html">AsyncTask</a></code> allows you to perform asynchronous work on your user
interface. It performs the blocking operations in a worker thread and then publishes the results on
the UI thread, without requiring you to handle threads and/or handlers yourself.</p>

<p>To use it, you must subclass <code><a href="../../reference/android/os/AsyncTask.html">AsyncTask</a></code> and implement the <code><a href="../../reference/android/os/AsyncTask.html#doInBackground(Params...)">doInBackground()</a></code> callback method, which runs in a pool of
background threads. To update your UI, you should implement <code><a href="../../reference/android/os/AsyncTask.html#onPostExecute(Result)">onPostExecute()</a></code>, which delivers the result from <code><a href="../../reference/android/os/AsyncTask.html#doInBackground(Params...)">doInBackground()</a></code> and runs in the UI thread, so you can safely
update your UI. You can then run the task by calling <code><a href="../../reference/android/os/AsyncTask.html#execute(Params...)">execute()</a></code>
from the UI thread.</p>

<p>For example, you can implement the previous example using <code><a href="../../reference/android/os/AsyncTask.html">AsyncTask</a></code> this
way:</p>

<pre>
public void onClick(View v) {
    new DownloadImageTask().execute("http://example.com/image.png");
}

private class DownloadImageTask extends AsyncTask&lt;String, Void, Bitmap&gt; {
    /** The system calls this to perform work in a worker thread and
      * delivers it the parameters given to AsyncTask.execute() */
    protected Bitmap doInBackground(String... urls) {
        return loadImageFromNetwork(urls[0]);
    }
    
    /** The system calls this to perform work in the UI thread and delivers
      * the result from doInBackground() */
    protected void onPostExecute(Bitmap result) {
        mImageView.setImageBitmap(result);
    }
}
</pre>

<p>Now the UI is safe and the code is simpler, because it separates the work into the
part that should be done on a worker thread and the part that should be done on the UI thread.</p>

<p>You should read the <code><a href="../../reference/android/os/AsyncTask.html">AsyncTask</a></code> reference for a full understanding on
how to use this class, but here is a quick overview of how it works:</p>

<ul>
<li>You can specify the type of the parameters, the progress values, and the final
value of the task, using generics</li>
<li>The method <code><a href="../../reference/android/os/AsyncTask.html#doInBackground(Params...)">doInBackground()</a></code> executes automatically
on a worker thread</li>
<li><code><a href="../../reference/android/os/AsyncTask.html#onPreExecute()">onPreExecute()</a></code>, <code><a href="../../reference/android/os/AsyncTask.html#onPostExecute(Result)">onPostExecute()</a></code>, and <code><a href="../../reference/android/os/AsyncTask.html#onProgressUpdate(Progress...)">onProgressUpdate()</a></code> are all invoked on the UI thread</li>
<li>The value returned by <code><a href="../../reference/android/os/AsyncTask.html#doInBackground(Params...)">doInBackground()</a></code> is sent to
<code><a href="../../reference/android/os/AsyncTask.html#onPostExecute(Result)">onPostExecute()</a></code></li>
<li>You can call <code><a href="../../reference/android/os/AsyncTask.html#publishProgress(Progress...)">publishProgress()</a></code> at anytime in <code><a href="../../reference/android/os/AsyncTask.html#doInBackground(Params...)">doInBackground()</a></code> to execute <code><a href="../../reference/android/os/AsyncTask.html#onProgressUpdate(Progress...)">onProgressUpdate()</a></code> on the UI thread</li>
<li>You can cancel the task at any time, from any thread</li>
</ul>

<p class="caution"><strong>Caution:</strong> Another problem you might encounter when using a worker
thread is unexpected restarts in your activity due to a <a
href="../../guide/topics/resources/runtime-changes.html">runtime configuration change</a>
(such as when the user changes the screen orientation), which may destroy your worker thread. To
see how you can persist your task during one of these restarts and how to properly cancel the task
when the activity is destroyed, see the source code for the <a
href="http://code.google.com/p/shelves/">Shelves</a> sample application.</p>


<h3 id="ThreadSafe">线程安全方法</h3>

<p>  In some situations, the methods you implement might be called from more than one thread, and
therefore must be written to be thread-safe.  </p>

<p>This is primarily true for methods that can be called remotely—such as methods in a <a
href="../../guide/components/bound-services.html">bound service</a>. When a call on a
method implemented in an <code><a href="../../reference/android/os/IBinder.html">IBinder</a></code> originates in the same process in which the
<code><a href="../../reference/android/os/IBinder.html">IBinder</a></code> is running, the method is executed in the caller's thread.
However, when the call originates in another process, the method is executed in a thread chosen from
a pool of threads that the system maintains in the same process as the <code><a href="../../reference/android/os/IBinder.html">IBinder</a></code> (it's not executed in the UI thread of the process).  For example, whereas a service's
<code><a href="../../reference/android/app/Service.html#onBind(android.content.Intent)">onBind()</a></code> method would be called from the UI thread of the
service's process, methods implemented in the object that <code><a href="../../reference/android/app/Service.html#onBind(android.content.Intent)">onBind()</a></code> returns (for example, a subclass that implements RPC methods) would be called from threads
in the pool. Because a service can have more than one client, more than one pool thread can engage
the same <code><a href="../../reference/android/os/IBinder.html">IBinder</a></code> method at the same time.  <code><a href="../../reference/android/os/IBinder.html">IBinder</a></code> methods must, therefore, be implemented to be thread-safe.</p>

<p>  Similarly, a content provider can receive data requests that originate in other processes.
Although the <code><a href="../../reference/android/content/ContentResolver.html">ContentResolver</a></code> and <code><a href="../../reference/android/content/ContentProvider.html">ContentProvider</a></code>
classes hide the details of how the interprocess communication is managed, <code><a href="../../reference/android/content/ContentProvider.html">ContentProvider</a></code> methods that respond to those requests—the methods <code><a href="../../reference/android/content/ContentProvider.html#query(android.net.Uri, java.lang.String[], java.lang.String, java.lang.String[], java.lang.String)">query()</a></code>, <code><a href="../../reference/android/content/ContentProvider.html#insert(android.net.Uri, android.content.ContentValues)">insert()</a></code>, <code><a href="../../reference/android/content/ContentProvider.html#delete(android.net.Uri, java.lang.String, java.lang.String[])">delete()</a></code>, <code><a href="../../reference/android/content/ContentProvider.html#update(android.net.Uri, android.content.ContentValues, java.lang.String, java.lang.String[])">update()</a></code>, and <code><a href="../../reference/android/content/ContentProvider.html#getType(android.net.Uri)">getType()</a></code>—are called from a pool of threads in the content provider's process, not the UI
thread for the process.  Because these methods might be called from any number of threads at the
same time, they too must be implemented to be thread-safe.  </p>


<h2 id="IPC">进程间通信</h2>

<p>Android offers a mechanism for interprocess communication (IPC) using remote procedure calls
(RPCs), in which a method is called by an activity or other application component, but executed
remotely (in another process), with any result returned back to the
caller. This entails decomposing a method call and its data to a level the operating system can
understand, transmitting it from the local process and address space to the remote process and
address space, then reassembling and reenacting the call there.  Return values are then
transmitted in the opposite direction.  Android provides all the code to perform these IPC
transactions, so you can focus on defining and implementing the RPC programming interface.  </p>

<p>To perform IPC, your application must bind to a service, using <code><a href="../../reference/android/content/Context.html#bindService(android.content.Intent, android.content.ServiceConnection, int)">bindService()</a></code>. For more information, see the <a
href="../../guide/components/services.html">Services</a> developer guide.</p><!--
<h2>Beginner's Path</h2>

<p>For information about how to perform work in the background for an indefinite period of time
(without a user interface), continue with the <b><a
href="../../guide/components/services.html">Services</a></b> document.</p>
-->




    </div>
      
      <div class="content-footer layout-content-row" 
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-8" style="padding-top:4px">
          
            <div class="g-plusone" data-size="medium"></div>
          
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>
      
      
      

  </div><!-- end jd-content --> 

<div id="footer" class="wrap" >
        

  <div id="copyright">
    
  
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../../license.html">Content 
  License</a>.
  
  </div>


  <div id="footerlinks">
    
  <p>
    <a href="../../about/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../support.html">Support</a>
  </p>
  </div>

</div><!-- end footer --> 
</div><!-- end doc-content -->

</div><!-- end body-content -->  






</body>
</html>



