<!DOCTYPE html>












































































<html>
<head>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width" />

<link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<title>Android 4.2 APIs | Android Developers</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="../../assets/css/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script src="../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "../../";
  var devsite = false;
</script>
<script src="../../assets/js/docs.js" type="text/javascript"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5831155-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="gc-documentation 
  about" itemscope itemtype="http://schema.org/Article">

<a name="top"></a>

    <!-- Header -->
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 logo">
          <a href="../../index.html">
            <img src="../../assets/images/dac_logo.png" width="123" height="25" alt="Android Developers" />
          </a>
          <div class="btn-quicknav" id="btn-quicknav">
          	<a href="#" class="arrow-inactive">Quicknav</a>
			      <a href="#" class="arrow-active">Quicknav</a>
          </div>
          </div>
            <ul class="nav-x col-9">
                <li class="design">
                  <a href="../../design/index.html"
                  zh-tw-lang="設計"
                  zh-cn-lang="设计"
                  ru-lang="Проектирование"
                  ko-lang="디자인"
                  ja-lang="設計"
                  es-lang="Diseñar"               
                  >Design</a></li>
                <li class="develop"><a href="../../develop/index.html"
                  zh-tw-lang="開發"
                  zh-cn-lang="开发"
                  ru-lang="Разработка"
                  ko-lang="개발"
                  ja-lang="開発"
                  es-lang="Desarrollar"               
                  >Develop</a></li>
                <li class="distribute last"><a href="../../distribute/index.html"
                  zh-tw-lang="發佈"
                  zh-cn-lang="分发"
                  ru-lang="Распространение"
                  ko-lang="배포"
                  ja-lang="配布"
                  es-lang="Distribuir"               
                  >Distribute</a></li>
            </ul>
            
            <!-- New Search -->
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Links</div>
      <ul>
        <li><a href="https://play.google.com/apps/publish/">Google Play Developer Console</a></li>
        <li><a href="http://android-developers.blogspot.com/">Android Developers Blog</a></li>
        <li><a href="../../about/index.html">About Android</a></li>
      </ul>
      <div class="header">Android Sites</div>
      <ul>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li class="active"><a>Android Developers</a></li>
        <li><a href="http://source.android.com">Android Open Source Project</a></li>
      </ul>
      
      
      
      


      <br class="clearfix" />
    </div>
    <div class="bottom"></div>
  </div>
  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
onkeydown="return search_changed(event, true, '../../')" 
onkeyup="return search_changed(event, false, '../../')" />
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>

  <div class="search_filtered_wrapper reference">
    <div class="suggest-card reference no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  <div class="search_filtered_wrapper docs">
    <div class="suggest-card dummy no-display">&nbsp;</div>
    <div class="suggest-card develop no-display">
      <ul class="search_filtered">
      </ul>
      <div class="child-card guides no-display">
      </div>
      <div class="child-card training no-display">
      </div>
    </div>
    <div class="suggest-card design no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card distribute no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  </div>
  <!-- /New Search>
          
          
          <!-- Expanded quicknav -->
           <div id="quicknav" class="col-9">
                <ul>
                    <li class="design">
                      <ul>
                        <li><a href="../../design/index.html">Get Started</a></li>
                        <li><a href="../../design/style/index.html">Style</a></li>
                        <li><a href="../../design/patterns/index.html">Patterns</a></li>
                        <li><a href="../../design/building-blocks/index.html">Building Blocks</a></li>
                        <li><a href="../../design/downloads/index.html">Downloads</a></li>
                        <li><a href="../../design/videos/index.html">Videos</a></li>
                      </ul>
                    </li>
                    <li class="develop">
                      <ul>
                        <li><a href="../../training/index.html"
                          zh-tw-lang="訓練課程"
                          zh-cn-lang="培训"
                          ru-lang="Курсы"
                          ko-lang="교육"
                          ja-lang="トレーニング"
                          es-lang="Capacitación"               
                          >Training</a></li>
                        <li><a href="../../guide/components/index.html"
                          zh-tw-lang="API 指南"
                          zh-cn-lang="API 指南"
                          ru-lang="Руководства по API"
                          ko-lang="API 가이드"
                          ja-lang="API ガイド"
                          es-lang="Guías de la API"               
                          >API Guides</a></li>
                        <li><a href="../../reference/packages.html"
                          zh-tw-lang="參考資源"
                          zh-cn-lang="参考"
                          ru-lang="Справочник"
                          ko-lang="참조문서"
                          ja-lang="リファレンス"
                          es-lang="Referencia"               
                          >Reference</a></li>
                        <li><a href="../../tools/index.html"
                          zh-tw-lang="相關工具"
                          zh-cn-lang="工具"
                          ru-lang="Инструменты"
                          ko-lang="도구"
                          ja-lang="ツール"
                          es-lang="Herramientas"               
                          >Tools</a>
                          <ul><li><a href="../../sdk/index.html">Get the SDK</a></li></ul>
                        </li>
                        <li><a href="../../google/index.html">Google Services</a>
                        </li>
                        
                      </ul>
                    </li>
                    <li class="distribute last">
                      <ul>
                        <li><a href="../../distribute/index.html">Google Play</a></li>
                        <li><a href="../../distribute/googleplay/publish/index.html">Publishing</a></li>
                        <li><a href="../../distribute/googleplay/promote/index.html">Promoting</a></li>
                        <li><a href="../../distribute/googleplay/quality/index.html">App Quality</a></li>
                        <li><a href="../../distribute/googleplay/spotlight/index.html">Spotlight</a></li>
                        <li><a href="../../distribute/open.html">Open Distribution</a></li>
                      </ul>
                    </li>
                </ul>
          </div>
          <!-- /Expanded quicknav -->
        </div>
    </div>
    <!-- /Header -->
    
    
  <div id="searchResults" class="wrap" style="display:none;">
          <h2 id="searchTitle">Results</h2>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div>
    
    
  




  

  <div class="wrap clearfix" id="body-content">
    <div class="col-3" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<a class="totop" href="#top" data-g-event="left-nav-top">to top</a>

<ul id="nav">
  
<li class="nav-section">
    <div class="nav-section-header"><a href="../../about/index.html">Welcome</a></div>
    <ul>
      <li><a href="../../about/start.html">Get Started</a></li>
    </ul>
  </li> 
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/kitkat.html">
      <span class="en">KitKat</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-4.4.html">Android 4.4 APIs</a></li>
      </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/jelly-bean.html">
      <span class="en">Jelly Bean</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-4.3.html">Android 4.3 APIs</a></li>
        <li><a href="../../about/versions/android-4.2.html">Android 4.2 APIs</a></li>
        <li><a href="../../about/versions/android-4.1.html">Android 4.1 APIs</a></li>
      </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/android-4.0-highlights.html">
      <span class="en">Ice Cream Sandwich</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-4.0.3.html">Android 4.0.3 APIs</a></li>
        <li><a href="../../about/versions/android-4.0.html">Android 4.0 APIs</a> </li>
      </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/android-3.0-highlights.html">
      <span class="en">Honeycomb</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-3.2.html">Android 3.2 APIs</a></li>
        <li><a href="../../about/versions/android-3.1.html">Android 3.1 APIs</a></li>
        <li><a href="../../about/versions/android-3.0.html">Android 3.0 APIs</a> </li>
      </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/android-2.3-highlights.html">
      <span class="en">Gingerbread</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-2.3.4.html">Android 2.3.4 APIs</a></li>
        <li><a href="../../about/versions/android-2.3.3.html">Android 2.3.3 APIs</a></li>
      </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header empty"><a href="../../about/dashboards/index.html">Dashboards</a></div>
  </li>

</ul>
        

      </div>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="col-13" id="doc-col" >


  
    
      
        <h1 itemprop="name" >Android 4.2 APIs</h1>
      
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <div id="qv-wrapper">
<div id="qv">
  
<h2>In this document</h2>
<ol>
  <li><a href="#Behaviors">Important Behavior Changes</a></li>
  <li><a href="#Daydream">Daydream</a></li>
  <li><a href="#SecondaryDisplays">Secondary Displays</a></li>
  <li><a href="#Lockscreen">Lockscreen Widgets</a></li>
  <li><a href="#MultipleUsers">Multiple Users</a></li>
  <li><a href="#RTL">RTL Layout Support</a></li>
  <li><a href="#NestedFragments">Nested Fragments</a></li>
  <li><a href="#Renderscript">Renderscript</a></li>
</ol>

<h2>See also</h2>
<ol>
<li><a
href="../../sdk/api_diff/17/changes.html">API
Differences Report &raquo;</a> </li>
</ol>

</div>
</div>


<p>API Level: 17</p>

<p>Android 4.2 (<code><a href="../../reference/android/os/Build.VERSION_CODES.html#JELLY_BEAN_MR1">JELLY_BEAN_MR1</a></code>)
is an update to the Jelly Bean release that offers new features for users and app
developers. This document provides an introduction to the most notable and
useful new APIs for developers.</p>

<p>As an app developer, you should download the Android 4.2 system image and SDK platform from
the <a href="../../tools/help/sdk-manager.html">SDK Manager</a> as soon as possible. If you
don’t have a device running Android 4.2 on which to test your app, use the Android 4.2 system
image to test your app on the <a href="../../tools/devices/emulator.html">Android emulator</a>.
Then build your apps against the Android 4.2 platform to begin using the latest APIs.</p>



<div class="sidebox-wrapper">
<div class="sidebox">  
  
<h3 id="ApiLevel">Declare your app API Level</h3>

<p>To better optimize your app for devices running Android 4.2,
  you should set your <a
href="../../guide/topics/manifest/uses-sdk-element.html#target"><code>targetSdkVersion</code></a> to
<code>"17"</code>, install it on an Android 4.2 system image,
test it, then publish an update with this change.</p>

<p>You
can use APIs in Android 4.2 while also supporting older versions by adding
conditions to your code that check for the system API level before executing
APIs not supported by your <a
href="../../guide/topics/manifest/uses-sdk-element.html#min"><code>minSdkVersion</code></a>. 
To learn more about
maintaining backward-compatibility, read <a
href="../../training/backward-compatible-ui/index.html">Creating Backward-Compatible
UIs</a>.</p>

<p>More information about how API levels work is available in <a
href="../../guide/topics/manifest/uses-sdk-element.html#ApiLevels">What is API
Level?</a></p>

</div>
</div>




<h2 id="Behaviors">Important Behavior Changes</h2>

<p>If you have previously published an app for Android, be aware of the following
changes that might affect your app’s behavior:</p>

<ul>
  <li><b>Content providers</b> are no longer exported by default. That is, the default value
for the <a href="../../guide/topics/manifest/provider-element.html#exported"><code>android:exported</code></a> attribute is now <code>“false"</code>. If it’s important that other apps be
able to access your content provider, you must now explicitly set <a
href="../../guide/topics/manifest/provider-element.html#exported"><code>android:exported="true"</code>.</a>
    <p>This change takes effect only if you set either <a
    href="../../guide/topics/manifest/uses-sdk-element.html#target"><code>android:targetSdkVersion</code></a> or <a href="../../guide/topics/manifest/uses-sdk-element.html#min"><code>android:minSdkVersion</code></a> to 17 or higher. Otherwise, the default value is still <code>“true"</code>
even when running on Android 4.2 and higher.</p>
  </li>
  
  <li>Compared to previous versions of Android, <b>user location</b> results may be less accurate
if your app requests the <code><a href="../../reference/android/Manifest.permission.html#ACCESS_COARSE_LOCATION">ACCESS_COARSE_LOCATION</a></code> permission but
does not request the <code><a href="../../reference/android/Manifest.permission.html#ACCESS_FINE_LOCATION">ACCESS_FINE_LOCATION</a></code> permission.
    <p>To meet the privacy expectations of users when your app requests permission for
coarse location (and not fine location), the system will not provide a user location estimate
that’s more accurate than a city block.</p>
  </li>
  
  <li>Some <b>device settings</b> defined by <code><a href="../../reference/android/provider/Settings.System.html">Settings.System</a></code> are now
  read-only. If your app attempts to write changes to settings defined in <code><a href="../../reference/android/provider/Settings.System.html">Settings.System</a></code> that have moved to <code><a href="../../reference/android/provider/Settings.Global.html">Settings.Global</a></code>,
  the write operation will silently fail when running on Android 4.2 and higher.
    <p>Even if your value for <a href="../../guide/topics/manifest/uses-sdk-element.html#target"><code>android:targetSdkVersion</code></a> and <a href="../../guide/topics/manifest/uses-sdk-element.html#min"><code>android:minSdkVersion</code></a> is lower than 17, your app is not able to modify the settings that have
moved to <code><a href="../../reference/android/provider/Settings.Global.html">Settings.Global</a></code> when running on Android 4.2 and higher.</p>
  </li>

  <li>If your app uses <code><a href="../../reference/android/webkit/WebView.html">WebView</a></code>, Android 4.2 adds an additional layer of
  security so you can more safely <b>bind JavaScript to your
  Android code</b>. If you set your
  <a href="../../guide/topics/manifest/uses-sdk-element.html#target"><code>targetSdkVersion</code></a>
  to 17 or higher, you must now add the <code>@JavascriptInterface</code> annotation to any method that you
  want available to your JavaScript (the method must also be public). If you do not provide the
  annotation, the method is not accessible by a web page in your <code><a href="../../reference/android/webkit/WebView.html">WebView</a></code>
  when running on Android 4.2 or higher. If you set the
  <a href="../../guide/topics/manifest/uses-sdk-element.html#target"><code>targetSdkVersion</code></a>
  to 16 or lower, the annotation is not required, but we recommend that you update your target version
  and add the annotation for additional security.
    <p>Read more about <a href="../../guide/webapps/webview.html#BindingJavaScript">binding
    JavaScript code to Android code</a>.</p></li>
</ul>






<h2 id="Daydream">Daydream</h2>

<p>Daydream is a new interactive screensaver mode for Android devices. It activates automatically
when the device is inserted into a dock or when the device is left idle while plugged in to a
charger (instead of turning the screen off). Daydream displays one dream at a time, which may
be a purely visual, passive display that dismisses upon touch, or may be interactive and responsive
to the full suite of input events. Your dreams run in your app’s process and have full access to
the Android UI toolkit, including views, layouts, and animations, so they are more flexible and
powerful than either live wallpapers or app widgets.</p>

<p>You can create a dream for Daydream by implementing a subclass of <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code>. The <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code> APIs are
designed to be similar to those of <code><a href="../../reference/android/app/Activity.html">Activity</a></code>. To specify the UI for your
dream, pass a layout resource ID or <code><a href="../../reference/android/view/View.html">View</a></code> to <code><a href="../../reference/android/service/dreams/DreamService.html#setContentView(android.view.View)">setContentView()</a></code> at any point after you have
a window, such as from the <code><a href="../../reference/android/service/dreams/DreamService.html#onAttachedToWindow()">onAttachedToWindow()</a></code>
callback.</p>

<p>The <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code> class provides other important lifecycle callback
methods on top of the base <code><a href="../../reference/android/app/Service.html">Service</a></code> APIs, such as <code><a href="../../reference/android/service/dreams/DreamService.html#onDreamingStarted()">onDreamingStarted()</a></code>, <code><a href="../../reference/android/service/dreams/DreamService.html#onDreamingStopped()">onDreamingStopped()</a></code>, and <code><a href="../../reference/android/service/dreams/DreamService.html#onDetachedFromWindow()">onDetachedFromWindow()</a></code>.
You cannot initiate a <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code> from your
app&mdash;it is launched automatically by the system.</p>

<p>If your dream is interactive, you can start an activity from the dream to send the user into
your app’s full UI for more detail or control. You can use <code><a href="../../reference/android/service/dreams/DreamService.html#finish()">finish()</a></code> to end the dream so the user can see the
new Activity.</p>

<p>To make your daydream available to the system, declare your <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code> with a <a
href="../../guide/topics/manifest/service-element.html"><code>&lt;service></code></a> element
in your manifest file. You must then include an intent filter with the action <code>"android.service.dreams.DreamService"</code>. For example:</p>

<pre>
&lt;service android:name=".MyDream" android:exported="true"
    android:icon="@drawable/dream_icon" android:label="@string/dream_label" >
    &lt;intent-filter>
        &lt;action android:name="android.service.dreams.DreamService" />
        &lt;category android:name="android.intent.category.DEFAULT" />
    &lt;/intent-filter>
&lt;/service>
</pre>

<p>There are some other useful methods in <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code>
to be aware of:</p>

<ul>
  <li><code><a href="../../reference/android/service/dreams/DreamService.html#setInteractive(boolean)">setInteractive(boolean)</a></code> controls whether
the dream receives input events or exits immediately upon user input. If the dream is
interactive, the user may use the <em>Back</em> or <em>Home</em> buttons to exit the dream or you can call
<code><a href="../../reference/android/service/dreams/DreamService.html#finish()">finish()</a></code> to stop the dream.</li>
  <li>If you want a fully immersive display, you can call <code><a href="../../reference/android/service/dreams/DreamService.html#setFullscreen(boolean)">setFullscreen()</a></code> to hide the status bar.</li>
  <li>Before Daydream starts, the display dims to signal to the user that the idle timeout
is approaching. Calling <code><a href="../../reference/android/service/dreams/DreamService.html#setScreenBright(boolean)">setScreenBright(true)</a></code> allows you to instead set the display at its usual brightness.</li>
</ul>

<p>For more information, see the <code><a href="../../reference/android/service/dreams/DreamService.html">DreamService</a></code> documentation.</p>











<h2 id="SecondaryDisplays">Secondary Displays</h2>

<p>Android now allows your app to display unique content on additional screens that are connected
to the user’s device over either a wired connection or Wi-Fi.
 To create unique content for a secondary display, extend the <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code>
class and implement the <code><a href="../../reference/android/app/Dialog.html#onCreate(android.os.Bundle)">onCreate()</a></code> callback. Within
<code><a href="../../reference/android/app/Dialog.html#onCreate(android.os.Bundle)">onCreate()</a></code>, specify your UI for the secondary display
by calling <code><a href="../../reference/android/app/Dialog.html#setContentView(android.view.View)">setContentView()</a></code>.
As an extension of the <code><a href="../../reference/android/app/Dialog.html">Dialog</a></code> class, the <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code> class provides the region in which your app can display a unique UI on the
secondary display.</p>

<p>To detect secondary displays where you can display your <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code>,
use either the <code><a href="../../reference/android/hardware/display/DisplayManager.html">DisplayManager</a></code> or <code><a href="../../reference/android/media/MediaRouter.html">MediaRouter</a></code>
APIs. While the <code><a href="../../reference/android/hardware/display/DisplayManager.html">DisplayManager</a></code> APIs allow you to enumerate
multiple displays that may be connected at once, you should usually use <code><a href="../../reference/android/media/MediaRouter.html">MediaRouter</a></code> instead to quickly access the system’s default display for
presentations.</p>

<p>To get the default display for your presentation, call <code><a href="../../reference/android/media/MediaRouter.html#getSelectedRoute(int)">MediaRouter.getSelectedRoute()</a></code> and pass it
<code><a href="../../reference/android/media/MediaRouter.html#ROUTE_TYPE_LIVE_VIDEO">ROUTE_TYPE_LIVE_VIDEO</a></code>. This returns a <code><a href="../../reference/android/media/MediaRouter.RouteInfo.html">MediaRouter.RouteInfo</a></code> object that describes the system’s currently selected route
for video presentations. If the <code><a href="../../reference/android/media/MediaRouter.RouteInfo.html">MediaRouter.RouteInfo</a></code> is not null, call
<code><a href="../../reference/android/media/MediaRouter.RouteInfo.html#getPresentationDisplay()">getPresentationDisplay()</a></code> to get the <code><a href="../../reference/android/view/Display.html">Display</a></code> representing the connected display.</p>

<p>You can then display your presentation by passing the <code><a href="../../reference/android/view/Display.html">Display</a></code> object
to a constructor for your <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code> class. Your presentation will now
appear on the secondary display.</p>

<p>To detect at runtime when a new display has been connected, create an instance of <code><a href="../../reference/android/media/MediaRouter.SimpleCallback.html">MediaRouter.SimpleCallback</a></code> in which you implement the <code><a href="../../reference/android/media/MediaRouter.Callback.html#onRoutePresentationDisplayChanged(android.media.MediaRouter, android.media.MediaRouter.RouteInfo)">onRoutePresentationDisplayChanged()</a></code> callback method, which the system will call when a new
presentation display is connected. Then register the <code><a href="../../reference/android/media/MediaRouter.SimpleCallback.html">MediaRouter.SimpleCallback</a></code> by passing it to <code><a href="../../reference/android/media/MediaRouter.html#addCallback(int, android.media.MediaRouter.Callback)">MediaRouter.addCallback()</a></code> along with the <code><a href="../../reference/android/media/MediaRouter.html#ROUTE_TYPE_LIVE_VIDEO">ROUTE_TYPE_LIVE_VIDEO</a></code> route type. When you receive a call to
<code><a href="../../reference/android/media/MediaRouter.Callback.html#onRoutePresentationDisplayChanged(android.media.MediaRouter, android.media.MediaRouter.RouteInfo)">onRoutePresentationDisplayChanged()</a></code>, simply call <code><a href="../../reference/android/media/MediaRouter.html#getSelectedRoute(int)">MediaRouter.getSelectedRoute()</a></code> as mentioned above.</p>

<p>To further optimize the UI in your <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code> for
secondary screens, you can apply
a different theme by specifying the <code><a href="../../reference/android/R.attr.html#presentationTheme">android:presentationTheme</a></code> attribute in the <a
href="../../guide/topics/resources/style-resource.html"><code>&lt;style></code></a> that you’ve
applied to your application or activity.</p>

<p>Keep in mind that screens connected to the user’s device often have a larger screen size and
likely a different screen density. Because the screen characteristics may different, you should
provide resources that are optimized specifically for such larger displays. If you need
to request additional resources from your <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code>, call <code><a href="../../reference/android/app/Dialog.html#getContext()">getContext()</a></code><code><a href="../../reference/android/content/Context.html#getResources()">.getResources()</a></code> to get the <code><a href="../../reference/android/content/res/Resources.html">Resources</a></code> object corresponding to the display. This provides
the appropriate resources from your app that are best suited for the
secondary display's screen size and density.</p>

<p>For more information and some code samples, see the <code><a href="../../reference/android/app/Presentation.html">Presentation</a></code>
class documentation.</p>










<h2 id="Lockscreen">Lockscreen Widgets</h2>

<p>Android now allows users to add app widgets to the lock screen. To make your <a
href="../../guide/topics/appwidgets/index.html">App Widget</a> available for use on the
lock screen, add the <code><a href="../../reference/android/appwidget/AppWidgetProviderInfo.html#widgetCategory">android:widgetCategory</a></code> attribute to your XML file that specifies the <code><a href="../../reference/android/appwidget/AppWidgetProviderInfo.html">AppWidgetProviderInfo</a></code>. This attribute supports two values: <code>home_screen</code>
and <code>keyguard</code>. By default, the attribute is set to <code>home_screen</code> so users can add your
app widget to the Home screen. If you want your app widget to be also available on the lock
screen, add the <code>keyguard</code> value:</p>

<pre>
&lt;appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    ...
    android:widgetCategory="keyguard|home_screen">
&lt;/appwidget-provider>
</pre>

<p>You should also specify an initial layout for your app widget when on the lock screen with
the <code><a href="../../reference/android/appwidget/AppWidgetProviderInfo.html#initialKeyguardLayout">android:initialKeyguardLayout</a></code> attribute. This works the same way as the <code><a href="../../reference/android/appwidget/AppWidgetProviderInfo.html#initialLayout">android:initialLayout</a></code>, in that it provides
a layout that can appear immediately until your app widget is initialized and able to update the
layout.</p>

<p>For more information about building app widgets for the lock screen, including to properly
size your app widget when on the lock screen, see the <a
href="../../guide/topics/appwidgets/index.html#lockscreen">App Widgets</a> guide.</p>







<h2 id="MultipleUsers">Multiple Users</h2>

<p>Android now allows multiple user spaces on shareable devices such as tablets. Each user on a
device has his or her own set of accounts, apps, system settings, files, and any other
user-associated data.</p>

<p>As an app developer, there’s nothing different you need to do in order for your app to work
properly with multiple users on a single device. Regardless of how many users may exist on a
device, the data your app saves for a given user is kept separate from the data your app saves
for other users. The system keeps track of which user data belongs to the user process in which
your app is running and provides your app access to only that user’s data and does not allow
access to other users’ data.</p>

<h3>Saving data in a multi-user environment</h3>

<p>Whenever your app saves user preferences, creates a database, or writes a file to the user’s
internal or external storage space, that data is accessible only while running as that user.</p>

<p>To be certain that your app behaves properly in a multi-user environment, do not refer to your
internal app directory or external storage location using hard-coded paths and instead always use
the appropriate APIs:</p>
<ul>
  <li>For access to internal storage, use <code><a href="../../reference/android/content/Context.html#getFilesDir()">getFilesDir()</a></code>, <code><a href="../../reference/android/content/Context.html#getCacheDir()">getCacheDir()</a></code>, or <code><a href="../../reference/android/content/Context.html#openFileOutput(java.lang.String, int)">openFileOutput()</a></code>.</li>
  <li>For access to external storage, use <code><a href="../../reference/android/content/Context.html#getExternalFilesDir(java.lang.String)">getExternalFilesDir()</a></code> or <code><a href="../../reference/android/os/Environment.html#getExternalStoragePublicDirectory(java.lang.String)">getExternalStoragePublicDirectory()</a></code>.
</ul>

<p>No matter which of these APIs you use to save data for a given user, the data will not be
accessible while running as a different user. From your app’s point of view, each user is running
on a completely separate device.</p>

<h3>Identifying users in a multi-user environment</h3>

<p>If your app wants to identify unique users such as to gather analytics or create other account
associations, you should follow the recommended practices for <a
href="http://android-developers.blogspot.com/2011/03/identifying-app-installations.html">identifying
unique installations</a>. By creating a new <code><a href="../../reference/java/util/UUID.html">UUID</a></code> when your app starts for the
first time, you’re certain to obtain a unique ID for tracking each user, regardless of how many
users install your app on a single device. Alternatively, you can save a local token fetched from
your server or use the registrations ID provided by <a
href="../../google/gcm/index.html">Google Cloud Messaging</a>.</p>

<p>Beware that if your app requests one of the hardware device identifiers (such as the WiFi MAC
address, the <code><a href="../../reference/android/os/Build.html#SERIAL">SERIAL</a></code> number, or the <code><a href="../../reference/android/provider/Settings.Secure.html#ANDROID_ID">ANDROID_ID</a></code> number), they will provide the same value for each
user because these identifiers are tied to the hardware and not the user. Not to mention the other
problems these identifiers introduce as discussed in the <a
href="http://android-developers.blogspot.com/2011/03/identifying-app-installations.html">Identifying
App Installations</a> blog post.</p>

<h3>New Global Settings</h3>

<p>The system settings have been updated to support multiple users with the addition of <code><a href="../../reference/android/provider/Settings.Global.html">Settings.Global</a></code>. This collection of settings is similar to <code><a href="../../reference/android/provider/Settings.Secure.html">Settings.Secure</a></code> settings because they are read-only, but applies globally across
all user spaces on the device.</p>

<p>Several existing settings were relocated here from either <code><a href="../../reference/android/provider/Settings.System.html">Settings.System</a></code> or <code><a href="../../reference/android/provider/Settings.Secure.html">Settings.Secure</a></code>. If your app is
currently making changes to settings previously defined in <code><a href="../../reference/android/provider/Settings.System.html">Settings.System</a></code>
(such as <code><a href="../../reference/android/provider/Settings.System.html#AIRPLANE_MODE_ON">AIRPLANE_MODE_ON</a></code>), then you should expect that
doing so will no longer work on a device running Android 4.2 or higher if those settings were
moved to <code><a href="../../reference/android/provider/Settings.Global.html">Settings.Global</a></code>. You can continue to read settings that are in
<code><a href="../../reference/android/provider/Settings.Global.html">Settings.Global</a></code>, but because the settings are no longer considered safe
for apps to change, attempting to do so will fail silently and the system will write a warning to
the system log when running your app on Android 4.2 or higher.</p>









<h2 id="RTL">RTL Layout Support</h2>

<p>Android now offers several APIs that allow you to build user interfaces that gracefully
transform layout orientation to support languages that use right-to-left (RTL) UIs and reading
direction, such as Arabic and Hebrew.</p>

<p>To begin supporting RTL layouts in your app, set the <code><a href="../../reference/android/R.attr.html#supportsRtl">android:supportsRtl</a></code> attribute to the <code>&lt;application></code> element in your manifest file
and set it <code>“true"</code>. Once you enable this, the system will enable various RTL APIs to
display your app with RTL layouts. For instance, the action bar will show the icon and title
on the right side and action buttons on the left, and any layouts you’ve created with the
framework-provided <code><a href="../../reference/android/view/View.html">View</a></code> classes will also be reversed.</p>

<p>If you need to further optimize the appearance of your app when displayed with an RTL layout,
there are two basic levels of optimization:</p>

<ol>
  <li>Convert left- and right-oriented layout properties to start- and end-oriented layout
properties.   
    <p>For example, use <code><a href="../../reference/android/R.attr.html#layout_marginStart">android:layout_marginStart</a></code>
in place of <code>android:layout_marginLeft</code> and <code><a href="../../reference/android/R.attr.html#layout_marginEnd">android:layout_marginEnd</a></code> in place of  <code>android:layout_marginRight</code>.
    <p>The <code><a href="../../reference/android/widget/RelativeLayout.html">RelativeLayout</a></code> class also provides the corresponding layout
attributes to replace left/right positions, such as <code>android:layout_alignParentStart</code> to
replace <code>android:layout_alignParentLeft</code> and <code>android:layout_toStartOf</code> instead of
<code>android:layout_toLeftOf</code>.
  </li>
  <li>Or to provide complete optimization for RTL layouts, you can provide entirely separate
layout files using the <code>ldrtl</code> resource qualifier (<code>ldrtl</code> stands for
layout-direction-right-to-left}). For example, you can save your default layout files in
<code>res/layout/</code> and your RTL optimized layouts in <code>res/layout-ldrtl/</code>.
    <p>The <code>ldrtl</code> qualifier is great for drawable resources, so that you can provide
graphics that are oriented in the direction corresponding to the reading direction.</p>
  </li>
</ol>

<p>Various other APIs are available across the framework to support RTL layouts, such as in
the <code><a href="../../reference/android/view/View.html">View</a></code> class so that you can implement the proper behaviors for custom
views and in <code><a href="../../reference/android/content/res/Configuration.html">Configuration</a></code> to query the current layout direction.</p>

<p><strong>Note:</strong> If you are using SQlite and have tables or column names that are
“number only," be
careful: using <a href="../../reference/java/lang/String.html#format(String, Object...)"><code>String.format(String, Object...)</code></a> can lead to errors where the numbers
have been converted to their Arabic equivalents if your device has been set to the Arabic locale.
You must use <a href="../../reference/java/lang/String.html#format(Locale,String,Object...)"><code>String.format(Locale,String,Object...)</code></a> to ensure numbers are
preserved as ASCII. Also use <a href="../../reference/java/lang/String.html#format(String,int)"><code>String.format("%d", int)</code></a> instead of using
<a href="../../reference/java/lang/String.html#valueOf(int)"><code>String.valueOf(int)</code></a> for
formatting numbers.</p>













<h2 id="NestedFragments">Nested Fragments</h2>

<p>You can now embed fragments inside fragments. This is useful for a variety of situations in
which you want to place dynamic and re-usable UI components into a UI component that is itself
dynamic and re-usable. For example, if you use <code><a href="../../reference/android/support/v4/view/ViewPager.html">ViewPager</a></code> to
create fragments that swipe left and right and consume a majority of the screen space, you can
now insert fragments into each fragment page.</p>

<p>To nest a fragment, simply call <code><a href="../../reference/android/app/Fragment.html#getChildFragmentManager()">getChildFragmentManager()</a></code> on
the <code><a href="../../reference/android/app/Fragment.html">Fragment</a></code> in which you want to add a fragment. This returns a <code><a href="../../reference/android/app/FragmentManager.html">FragmentManager</a></code> that you can use like you normally do from the top-level activity
to create fragment transactions. For example, here’s some code that adds a fragment from within
an existing <code><a href="../../reference/android/app/Fragment.html">Fragment</a></code> class:</p>

<pre>
Fragment videoFragment = new VideoPlayerFragment();
FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
transaction.add(R.id.video_fragment, videoFragment).commit();
</pre>

<p>From within a nested fragment, you can get a reference to the parent fragment by calling
<code><a href="../../reference/android/app/Fragment.html#getParentFragment()">getParentFragment()</a></code>.</p>

<p>The Android Support Library also now supports nested fragments, so you can implement nested
fragment designs on Android 1.6 and higher.</p>

<p><strong>Note:</strong> You cannot inflate a layout into a fragment when that layout
includes a <code>&lt;fragment></code>. Nested fragments are only supported when added to a
fragment dynamically.</p>






<h2 id="Renderscript">Renderscript</h2>

<p>Renderscript computation functionality has been enhanced with the following features:</p>
<dl>
  <dt><b>Script intrinsics</b></dt>
  <dd><p>You can use Renderscript's built-in script intrinsics that implement
common operations for you such as:</p>
    <ul>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicBlend.html">Blends</a></code></li>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicBlur.html">Blur</a></code></li>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicColorMatrix.html">Color matrix</a></code></li>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicConvolve3x3.html">3x3 convolve</a></code></li>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicConvolve5x5.html">5x5 convolve</a></code></li>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicLUT.html">Per-channel lookup table</a></code></li>
    <li><code><a href="../../reference/android/renderscript/ScriptIntrinsicYuvToRGB.html">Converting an Android YUV buffer to RGB</a></code></li>
    </ul>
  <p>To use a script intrinsic, call the static <code>create()</code> method of each instrinsic
  to create an instance of the script. You then call the available <code>set()</code>
  methods of each script intrinsic to set any necessary inputs and options.
  Finally, call the <code><a href="../../reference/android/renderscript/Script.html#forEach(int, android.renderscript.Allocation, android.renderscript.Allocation, android.renderscript.FieldPacker)">forEach()</a></code></code>
  method to execute the script.</p>
  </dd>


<dt><b>Script Groups</b></dt>
<dd>
<p><code><a href="../../reference/android/renderscript/ScriptGroup.html">ScriptGroup</a></code>s allow you to chain together related Renderscript
scripts and execute them with one call.</p>

<p>Use a <code><a href="../../reference/android/renderscript/ScriptGroup.Builder.html">ScriptGroup.Builder</a></code> to add all of the scripts to the group
by calling <code><a href="../../reference/android/renderscript/ScriptGroup.Builder.html#addKernel(android.renderscript.Script.KernelID)">addKernel()</a></code>. Once you
add all the scripts, create the connections between the
scripts by calling <code><a href="../../reference/android/renderscript/ScriptGroup.Builder.html#addConnection(android.renderscript.Type, android.renderscript.Script.KernelID, android.renderscript.Script.FieldID)">addConnection()</a></code>.
When you are done adding the connections, call <code><a href="../../reference/android/renderscript/ScriptGroup.Builder.html#create()">create()</a></code>
to create the script group. Before executing the script group, specify the input
<code><a href="../../reference/android/renderscript/Allocation.html">Allocation</a></code> and initial script to run with the 
<code><a href="../../reference/android/renderscript/ScriptGroup.html#setInput(android.renderscript.Script.KernelID, android.renderscript.Allocation)">setInput(Script.KernelID, Allocation)</a></code> method and provide the output
<code><a href="../../reference/android/renderscript/Allocation.html">Allocation</a></code> where the result will be written to and final script to
run with <code><a href="../../reference/android/renderscript/ScriptGroup.html#setOutput(android.renderscript.Script.KernelID, android.renderscript.Allocation)">setOutput()</a></code>. Finally, call
<code><a href="../../reference/android/renderscript/ScriptGroup.html#execute()">execute()</a></code> to run the script group.
</p>
</dd>

<dt><b>Filterscript</b></dt>
<dd>
<p>Filterscript defines constraints on the existing Renderscript APIs that allow the resulting code to run
on a wider variety of processors (CPUs, GPUs, and DSPs). To create Filterscript files, create <code>.fs</code>
files instead of <code>.rs</code> files, and specify <code>#pragma rs_fp_relaxed</code> to
tell the Renderscript runtime your scripts do not require strict IEEE 754-2008 floating point precision.
This precision allows flush-to-zero for denorms and round-towards-zero. In addition, your Filterscript
scripts must not use 32-bit built-in types and must specify a custom root function by using the
<code>__attribute__((kernel))</code> attribute because Filterscript does not support pointers, which
the default signature of the <code>root()</code> function defines.</p>
</dd>

</dl>

<p class="note"><strong>Note:</strong> Although Filterscript support is in the platform, developer
support will be available in ADT and SDK Tools Release 21.0.1. </p>


<p>For a detailed view of all API changes in Android 4.2, see the
<a href="../../sdk/api_diff/17/changes.html">API Differences Report</a>.</p>




    </div>
      
      <div class="content-footer layout-content-row" 
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-9" style="padding-top:4px">
          
            <div class="g-plusone" data-size="medium"></div>
          
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>
      
      
      

  </div> <!-- end jd-content -->

<div id="footer" class="wrap" >
        

  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../../license.html">Content 
  License</a>.
  </div>


  <div id="footerlinks">
    
  <p>
    <a href="../../about/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../support.html">Support</a>
  </p>
  </div>

</div> <!-- end footer -->
</div><!-- end doc-content -->

</div> <!-- end body-content --> 






</body>
</html>



